webpackJsonp([1],{275:function(e,t,a){"use strict";function s(e){return e&&e.__esModule?e:{"default":e}}function l(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function n(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function r(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var o=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var s in a)Object.prototype.hasOwnProperty.call(a,s)&&(e[s]=a[s])}return e},d=function(){function e(e,t){for(var a=0;a<t.length;a++){var s=t[a];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(e,s.key,s)}}return function(t,a,s){return a&&e(t.prototype,a),s&&e(t,s),t}}(),i=a(4),c=s(i),u=(a(14),a(11)),p=a(24),m=a(27),f=function(e){function t(){return l(this,t),n(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return r(t,e),d(t,[{key:"shouldComponentUpdate",value:function(e,t){return!(this.props===e||(0,u.is)((0,u.fromJS)(this.props),(0,u.fromJS)(e)))||!(this.state===t||(0,u.is)((0,u.fromJS)(this.state),(0,u.fromJS)(t)))}},{key:"render",value:function(){return c["default"].createElement("ul",{className:"team_list"},this.props.list.map(function(e,t){return c["default"].createElement(h,o({key:t},e,{index:t}))}))}}]),t}(i.Component),h=function(e){function t(e,a){l(this,t);var s=n(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,a));return s.state={},s.deleleOrder=function(){s.context.getData("/sales/sales/deleteSales",{sales_id:s.props.sales_id},function(e){200==e.http_code?(s.context.deleteItem(s.props.index),p.Tool.alert(e.data.msg)):p.Tool.alert(e.msg)},"deleteItem")},s}return r(t,e),d(t,[{key:"shouldComponentUpdate",value:function(e,t){return!(this.props===e||(0,u.is)((0,u.fromJS)(this.props),(0,u.fromJS)(e)))||!(this.state===t||(0,u.is)((0,u.fromJS)(this.state),(0,u.fromJS)(t)))}},{key:"render",value:function(){var e=this.props,t=e.created_at,a=e.customers_phone,s=e.customers_name,l=e.product,n=(e.product_price,e.commission),r=e.sales_money,o=e.type,d=(e.sales_id,e.index,e.content),i=void 0,u=void 0,p=t.split(":");return t=p[0]+":"+p[1],"FAILED"==o?(i=c["default"].createElement("span",{className:"order_status1"},"未通过"),u=c["default"].createElement("div",{className:"failed_reason clear"},c["default"].createElement("span",{className:"left"},"未通过原因："),c["default"].createElement("span",{className:"reason_content left"},d),c["default"].createElement("span",{className:"right delete_order",onClick:this.deleleOrder},"删除"))):"UNAUDIT"==o?(i=c["default"].createElement("span",{className:"order_status1"},"待审核"),u=c["default"].createElement("div",{className:"failed_reason"},"等待管理员审核，审核通过后，佣金将结算至账户")):"PASS"==o&&(i=c["default"].createElement("span",{className:"order_status2"},"已通过"),u=null),c["default"].createElement("li",{className:"order_li"},c["default"].createElement("header",null,"创建时间：",t,i),c["default"].createElement("div",{className:"order_inform"},c["default"].createElement("div",{className:"order_style"},c["default"].createElement("span",null,"客",c["default"].createElement("span",{style:{display:"inline-block",width:"1.3rem"}}),"户："),c["default"].createElement("span",{style:{marginRight:"0.875rem"}},s),c["default"].createElement("span",null,a)),c["default"].createElement("div",{className:"order_style ellips"},c["default"].createElement("span",null,"购买商品："),l.map(function(e,t){return c["default"].createElement("span",{style:{marginRight:"0.875rem"},key:t},e.product_name)})),c["default"].createElement("div",{className:"order_style"},c["default"].createElement("span",null,"订单金额："),c["default"].createElement("span",{style:{marginRight:"1.95rem",color:"red"}},"¥",r),c["default"].createElement("span",null,"佣金："),c["default"].createElement("span",{style:{color:"red"}},"¥",n))),u)}}]),t}(i.Component);h.contextTypes={deleteItem:c["default"].PropTypes.any};var g=function(e){function t(e,a){l(this,t);var s=n(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,a));return s.state={data:[],oldName:"waited",choosedClass:{waited:"team_choosed"},currentPage:1,totalPage:1,limit:20,shouldUpdata:!0},s.chooseStatus=function(e){var t=null;if(t=e.target.children[0]?e.target.children[0].getAttribute("name"):e.target.getAttribute("name"),t!==s.state.oldName){s.state.oldName=t,s.state.choosedClass={},s.state.choosedClass[t]="team_choosed",s.setState(s.state.choosedClass);var a="";"failed"==t?a="FAILED":"waited"==t?a="UNAUDIT":"passed"==t&&(a="PASS"),s.props.getData("/sales/sales/salesList",{page:1,type:a},function(e){200==e.http_code?s.setState({data:e.data.data,currentPage:1,totalPage:e.data.totalPage}):p.Tool.alert(e.msg)},"changeType")}},s.deleteInform=function(e){s.state.data.splice(e,1)},s.getNextPage=function(e){if(s.state.shouldUpdata){s.state.shouldUpdata=!1;var t="";"failed"==s.state.oldName?t="FAILED":"waited"==s.state.oldName?t="UNAUDIT":"passed"==s.state.oldName&&(t="PASS"),s.props.getData("/sales/sales/salesList",{page:e,type:t},function(t){s.state.currentPage=e,s.state.shouldUpdata=!0,200==t.http_code?(s.state.data=s.state.data.concat(t.data.data),s.setState(s.state.data)):p.Tool.alert(t.msg)},"nextPage")}},s}return r(t,e),d(t,[{key:"getChildContext",value:function(){return{deleteItem:this.props.deleteItem,getData:this.props.getData}}},{key:"componentWillReceiveProps",value:function(e){if(void 0!==e.saleRecord.index)this.deleteInform(e.saleRecord.index);else{var t=e.state.data;this.state.data=t&&t.data&&t.data.data||[],this.state.currentPage=t&&t.data&&t.data.currentPage||1,this.state.totalPage=t&&t.data&&t.data.totalPage||1}}},{key:"componentWillUpdate",value:function(e,t){}},{key:"shouldComponentUpdate",value:function(e,t){return!(this.props===e||(0,u.is)((0,u.fromJS)(this.props),(0,u.fromJS)(e)))||!(this.state===t||(0,u.is)((0,u.fromJS)(this.state),(0,u.fromJS)(t)))}},{key:"render",value:function(){return this.state.currentPage<this.state.totalPage&&p.Tool.nextPage(this.refs.Container,this.state.currentPage,this.state.totalPage,this.getNextPage,this.state.shouldUpdata),c["default"].createElement("div",{ref:"Container",className:"component_container"},c["default"].createElement(m.Header,{goback:!0,title:"销售记录"}),c["default"].createElement("nav",{className:"team_nav"},c["default"].createElement("ul",{className:"clear",onClick:this.chooseStatus},c["default"].createElement("li",{className:this.state.choosedClass.failed},c["default"].createElement("p",{name:"failed"},"未通过"),c["default"].createElement("span",null)),c["default"].createElement("li",{className:this.state.choosedClass.waited},c["default"].createElement("p",{name:"waited"},"待审核"),c["default"].createElement("span",null)),c["default"].createElement("li",{className:this.state.choosedClass.passed},c["default"].createElement("p",{name:"passed"},"已通过")))),this.state.data.length>0?c["default"].createElement(f,{list:this.state.data}):null)}}]),t}(i.Component);g.propTypes={saleRecord:i.PropTypes.object.isRequired},g.childContextTypes={deleteItem:c["default"].PropTypes.any,getData:c["default"].PropTypes.any},t["default"]=(0,m.template)({id:"saleRecord",component:g,url:"/sales/sales/salesList",data:{page:1,type:"UNAUDIT"}})}});