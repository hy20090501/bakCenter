webpackJsonp([3],{271:function(t,e,o){"use strict";function a(t){return t&&t.__esModule?t:{"default":t}}function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function n(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function s(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}Object.defineProperty(e,"__esModule",{value:!0});var i=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var o=arguments[e];for(var a in o)Object.prototype.hasOwnProperty.call(o,a)&&(t[a]=o[a])}return t},c=function(){function t(t,e){for(var o=0;o<e.length;o++){var a=e[o];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(t,a.key,a)}}return function(e,o,a){return o&&t(e.prototype,o),a&&t(e,a),e}}(),u=o(4),d=a(u),p=(o(21),o(14),o(11)),l=(o(24),o(27)),h=function(t){function e(){return r(this,e),n(this,(e.__proto__||Object.getPrototypeOf(e)).apply(this,arguments))}return s(e,t),c(e,[{key:"shouldComponentUpdate",value:function(t,e){return!(this.props===t||(0,p.is)((0,p.fromJS)(this.props),(0,p.fromJS)(t)))||!(this.state===e||(0,p.is)((0,p.fromJS)(this.state),(0,p.fromJS)(e)))}},{key:"render",value:function(){return d["default"].createElement("div",null,d["default"].createElement("ul",{className:"product_list_ul"},this.props.list.map(function(t,e){return d["default"].createElement(f,i({key:e},t,{index:e}))})))}}]),e}(u.Component),f=function(t){function e(t,o){r(this,e);var a=n(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t,o));return a.state={productCount:a.props.num,chooseState:a.props.chooseState},a.getProductCount=function(t){if(a.state.chooseState){var e=a.state.productCount;"reduce"==t&&e>0?(e-=1,a.setState({productCount:e})):"add"==t&&(e+=1,a.setState({productCount:e})),a.context.recordState(a.props.id,a.state.chooseState,e,a.props.index)}},a.handleChange=function(t){if(a.state.chooseState){var e=t.target.value;e=Number(e.replace(/\D+/gi,"")),a.setState({productCount:e}),a.context.recordState(a.props.id,a.state.chooseState,e,a.props.index)}},a.changeState=function(){var t=!a.state.chooseState;a.setState({chooseState:t}),a.context.recordState(a.props.id,t,a.state.productCount,a.props.index)},a}return s(e,t),c(e,[{key:"shouldComponentUpdate",value:function(t,e){return!(this.props===t||(0,p.is)((0,p.fromJS)(this.props),(0,p.fromJS)(t)))||!(this.state===e||(0,p.is)((0,p.fromJS)(this.state),(0,p.fromJS)(e)))}},{key:"render",value:function(){var t=this.props,e=t.productName,o=(t.id,this.state.productCount);return d["default"].createElement("li",{className:"chooseProduct_item clear"},d["default"].createElement("div",{className:"chooseItem_left ellips left "+(1==this.state.chooseState?"choosed":""),onClick:this.changeState}," ",e),d["default"].createElement("div",{className:"chooseItem_right right"},d["default"].createElement("button",{disabled:o>0?"":"disabled",className:(o>0?"reduce":"reduce_no")+" button_style ",onClick:this.getProductCount.bind(this,"reduce")}),d["default"].createElement("input",{type:"text",className:"product_num",maxLength:"5",value:o,onChange:this.handleChange}),d["default"].createElement("button",{className:"add button_style",onClick:this.getProductCount.bind(this,"add")})))}}]),e}(u.Component);f.contextTypes={recordState:d["default"].PropTypes.any};var m=function(t){function e(t,o){r(this,e);var a=n(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t,o));return a.state={productList:[],params:"",shouldUpdata:!1,left:0,num:0,director:-1,requestID:null,clientWidth:0,moving:!1},a.productsState=function(t,e,o,r){a.state.productList[r].chooseState=e,a.state.productList[r].num=o,a.props.saveProductlist(a.state.productList)},a.move=function(){a.state.clientWidth=document.documentElement.clientWidth,a.state.director=a.state.director*-1,cancelAnimationFrame(a.state.requestID),a.getMove(),a.state.moving=!0},a.getMove=function(){a.state.requestID=requestAnimationFrame(function(){a.state.num=4*a.state.director+a.state.num,a.setState({left:a.state.num+"px"}),a.state.num>=a.state.clientWidth-100?a.state.director=a.state.director*-1:a.state.num<=0&&(a.state.director=a.state.director*-1),a.getMove()})},a}return s(e,t),c(e,[{key:"getChildContext",value:function(){return{recordState:this.props.recordState}}},{key:"componentWillReceiveProps",value:function(t){var e=this;if(this.state.shouldUpdata=!1,this.props!==t){var o=t.state.data;if(t.producRecord.productList&&0==this.state.productList.length)this.state.shouldUpdata=!0,this.state.productList=t.producRecord.productList;else if(o&&o.data&&o.data.data&&0==this.state.productList.length){this.state.shouldUpdata=!0;var a=o.data.data;this.props.newProductData(a),a.forEach(function(t,o){e.state.productList[o]={},e.state.productList[o].productName=t.product_name,e.state.productList[o].chooseState=!1,e.state.productList[o].id=t.product_id,e.state.productList[o].num=1})}if(t.producRecord.id){var r=t.producRecord;this.productsState(r.id,r.chooseState,r.num,r.index)}}}},{key:"componentWillUpdate",value:function(t,e){}},{key:"componentWillMount",value:function(){this.state.params=this.props.location.search}},{key:"shouldComponentUpdate",value:function(t,e){return!(this.props===t||(0,p.is)((0,p.fromJS)(this.props),(0,p.fromJS)(t)))||!(this.state===e||(0,p.is)((0,p.fromJS)(this.state),(0,p.fromJS)(e)))&&(this.state.shouldUpdata||this.state.moving)}},{key:"componentWillUnmount",value:function(){cancelAnimationFrame(this.state.requestID)}},{key:"render",value:function(){var t={position:"fixed",backgroundColor:"red",height:"100px",width:"100px",zIndex:99999,left:this.state.left,bottom:"0"};return d["default"].createElement("div",{className:"component_container"},d["default"].createElement("div",{style:t,onClick:this.move}),d["default"].createElement(l.Header,{goback:!0,title:"销售商品",save:!0,params:this.state.params}),this.state.productList.length>0?d["default"].createElement(h,{list:this.state.productList}):null)}}]),e}(u.Component);m.childContextTypes={recordState:d["default"].PropTypes.any},e["default"]=(0,l.template)({id:"chooseProducts",component:m,url:"/sales/sales/productList"})}});